<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA | {% block head_title %}Inicio{% endblock %}</title>
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/plugins/toastr/toastr.min.css' %}" rel="stylesheet">
    <!--<link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">-->
    <link href="{% static 'font-awesome/css/font-awesome.css' %}" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet"><link href="{% static 'css/main.css' %}" rel="stylesheet">
    <link href="{% static 'ionicons/css/ionicons.css' %}" rel="stylesheet">
    <link href="{% static 'fontawesome-free\web-fonts-with-css\css\fontawesome-all.css' %}" rel="stylesheet">
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>-->
    <!--<link href="{{ STATIC_URL }}css/bootstrap.css" rel="stylesheet" type="text/css"/>-->
    <link href="{% static 'animate.css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'animate.css/animate.css/animate.min.css' %}" rel="stylesheet">

    <link href="{% static 'css/plugins/fullcalendar/fullcalendar.css' %}" rel="stylesheet">
    <link href="{% static 'css/plugins/fullcalendar/fullcalendar.print.css' %}" rel="stylesheet" media="print">
    <link href="{% static 'select2/dist/css/select2.css' %}" rel="stylesheet">
    <link href="{% static 'select2/dist/css/select2.css/select2.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/alertify.bootstrap.css' %}" rel="stylesheet">
    <link href="{% static 'css/alertify.core.css' %}" rel="stylesheet">
    <link href="{% static 'css/alertify.default.css' %}" rel="stylesheet">
    <link href="{% static 'css/bootstrap-dialog.min.css' %}" rel="stylesheet">

    <!--<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.7/css/bootstrap-dialog.min.css" rel="stylesheet"/>-->

    {{ form.media }}
    {% block css %}{% endblock %}
</head>

<body>
<div id="wrapper">
    {% include 'base/_navbar_left.html' %}
    <div id="page-wrapper" class="white-bg">
        {% include 'base/_navbar_top.html' %}
        <div class="wrapper wrapper-content animated fadeInUp">
            {% block content %}
                <div class="row">
                    <div class="col-lg-12">
                        <div class="text-center m-t-lg">
                            <h1>Bienvenido a Sistema Prestamo</h1>
                            <small>...</small>
                        </div>
                    </div>
                </div>
            {% endblock %}
        </div>
        <div class="footer">
            <div class="pull-right">Creado por <strong>Esteban Pando E. - Gonzalo Sep√∫lveda N. - Claudio Contreras B.</strong></div>
            <div><strong>Copyright</strong> Virginio Gomez &copy; 2018</div>
        </div>
    </div>
</div>

<!-- Mainly scripts -->


<script src="{% static 'js/plugins/fullcalendar/moment.min.js' %}"></script>
<script src="{% static 'js/plugins/fullcalendar/jquery.min.js' %}"></script>


<script src="{% static 'js/jquery-3.1.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>

<!--<script src="{% static 'js/plugins/toastr/toastr.min.js' %}"></script>-->
<script src="{% static 'js/plugins/metisMenu/jquery.metisMenu.js' %}"></script>
<script src="{% static 'js/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>

<!-- Custom and plugin javascript -->
<script src="{% static 'js/inspinia.js' %}"></script>
<script src="{% static 'js/plugins/pace/pace.min.js' %}"></script>
<script src="{% static 'js/bootstrap-dialog.js' %}"></script>


<script src="{% static 'js/bootstrap.min.js'%}"></script>

<script src="{% static 'select2/dist/js/select2.full.js' %}"></script>
<!--<script src="{% static 'select2/dist/js/select2.full.js/select2.full.min.js' %}"></script>-->
<script src="{% static 'select2/dist/js/select2.js' %}"></script>
<!--<script src="{% static 'select2/dist/js/select2.js/select2.min.js' %}"></script>-->
<!--<script src="{% static 'select2/dist/js/i18n/es.js' %}"></script>-->

<script src="{% static 'select2/src/js/jquery.select2.js' %}"></script>
<script src="{% static 'select2/src/js/select2/i18n/es.js' %}"></script>


<script src="{% static 'js/plugins/fullcalendar/fullcalendar.min.js' %}" ></script>
<script src="{% static 'js/plugins/fullcalendar/locale/es.js' %}" ></script>

<script src="{% static 'js/alertify.js' %}" ></script>
<script src="{% static 'js/alertify.min.js' %}" ></script>


{% include "base/_notifications.html" %}


<script>
  $(function() {
    var activePage = stripTrailingSlash(window.location.pathname);

    function stripTrailingSlash(str) {
      if (str.substr(-1) == '/') {
        return str.substr(0, str.length - 1);
      }

      return str;
    }

    var pageActivated = false;

    $('.nav li a').each(function(){
      var currentPage = stripTrailingSlash($(this).attr('href'));

      if (activePage == currentPage) {
        $(this).parent().addClass('active');

        $(this).parent().parent().parent().parent().addClass('in');
        $(this).parent().parent().parent().parent().parent().addClass('active')

        var ul = $(this).closest('ul.collapse');
        if (ul) {
          $(ul).addClass('in');
          $(ul).closest('li').addClass('active');
          pageActivated = true;
        }
      }
    });

    if (!pageActivated) {
      $('.nav li a').each(function() {
        var currentPage = stripTrailingSlash($(this).attr('href'));

        if (activePage.indexOf(currentPage) !== -1) {
          $(this).addClass('active');
          var ul = $(this).closest('ul.collapse');

          if (ul) {
            $(ul).addClass('in');
            $(ul).closest('li').addClass('active');
          }
        }
      });
    }
  });

  $('#dialog').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Total de Productos',
          message: $('<div></div>').load("{% url 'mantenedor:producto_listar_dialog' %}"),
          type: BootstrapDialog.TYPE_INFO,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-info',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

   $('#dialog1').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Prestamos Activos',
          message: $('<div></div>').load("{% url 'prestamos:list_prestamos' %}"),
          type: BootstrapDialog.TYPE_SUCCESS,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-primary',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

   $('#e').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Reserva de Laboratorio',
          message: $('<div></div>').load("{% url 'laboratorio:list_reservas' %}"),
          type: BootstrapDialog.TYPE_WARNING,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-warning',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

   $('#c').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Prestamos Atrasados',
          message: $('<div></div>').load("{% url 'prestamos:list_prestamos_atrasados' %}"),
          type: BootstrapDialog.TYPE_DANGER,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-danger',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

  $('#d').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Productos Disponibles',
          message: $('<div></div>').load("{% url 'mantenedor:producto_listar_dialog2' %}"),
          type: BootstrapDialog.TYPE_PRIMARY,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-success',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

  $('#reparacion').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Productos en Mantencion',
          message: $('<div></div>').load("{% url 'mantenedor:producto_listar_dialog3' %}"),
          type: BootstrapDialog.TYPE_INFO,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-info',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

  $('#prestados').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Productos Actualmente en Prestamo',
          message: $('<div></div>').load("{% url 'mantenedor:producto_listar_dialog4' %}"),
          type: BootstrapDialog.TYPE_SUCCESS,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-primary',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

  $('#baja').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Productos Dados de Baja del Sistema',
          message: $('<div></div>').load("{% url 'mantenedor:producto_listar_dialog5' %}"),
          type: BootstrapDialog.TYPE_DANGER,
          cssClass: 'type-warning',
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-danger',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });

  $('#usuarios').click(function() {
      var dialogo = BootstrapDialog.show({
          title: 'Usuarios Actuales en el Sistema',
          message: $('<div></div>').load("{% url 'home:usuarios' %}"),
          type: BootstrapDialog.SUCCESS,
          cssClass: 'type-success',
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-success',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });
  });




  $(document).ready(function() {

        $('#usuario').select2({
                width:'100%',
                theme: 'default',
                language : 'es',
                placeholder: 'Seleccione Usuario'
            });

        $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay,listWeek'

            },
            nowIndicator: true,
            minTime: "08:00:00",
            maxTime: "19:00:00",
            locale: 'es',
            weekends : false,
            editable: true,

            events: [

                {% for i in eventlist %}

                {
                    id : '{{ i.id }}',
                    title: "{{ i.title }}" + " " + "{{ i.usuario__username}}",
                    start: '{{ i.start|date:"Y-m-d H:i"}}',
                    end : '{{ i.end|date:"Y-m-d H:i"}}',

                },

                {% endfor %}

            ],

            dayClick: function(date, jsEvent, view) {



                var dialogo = BootstrapDialog.show({
                    title: 'Registrar Evento',
                    type: BootstrapDialog.TYPE_SUCCESS,

                    message: $('<div></div>').load("{% url 'laboratorio:laboratorio_modal' %}"),
                    buttons:[{
                       label: 'Guardar Evento',
                        cssClass: 'btn-primary',
                        action: function (dialog) {
                            var datos=$("#FormularioEventos").serialize();
                            console.log(datos);
                            $.post("{% url 'laboratorio:laboratorio_modal' %}",datos,function (data) {
                                console.log(data);
                                NuevoEvento = {
                                    title: $('#id_title').val() + $('#id_usuario').val(),
                                    start: $('#id_start').val(),
                                    end : $('#id_end').val(),

                                }
                                $('#calendar').fullCalendar('renderEvent',NuevoEvento);
                                dialog.close();

                            });
                        }
                    }]
                });

            },

            eventClick:function(calEvent, jsEvent, view) {

                var dialogo = BootstrapDialog.show({
          title: 'Detalle de Evento',
          message: $('<div></div>').load("/laboratorio/editar/"+calEvent.id+"/"),
          type: BootstrapDialog.TYPE_SUCCESS,
          buttons:[{
              label: 'Cerrar',
            cssClass: 'btn-primary',
              action: function(dialog){
                  dialog.close();
              }
          }]
      });

            },

            eventLimit : true,
            views : {
                agenda: {
                    eventLimit : 4
                }
            },


        });


    });

</script>



<script>
    $(document).ready(function() {
        $('#id_id_producto').select2({
            width:'100%',
            theme: 'default',
            placeholder: 'Seleccione Producto',
            language: "es"
        });
    });


</script>

<script>
    $(document).ready(function() {
        $('#usuario').select2({
            width:'100%',
            theme: 'default',
            language : 'es',
            placeholder: 'Seleccione Usuario'
        });
    });


</script>

{% block after_content %} {% endblock %}
</body>
</html>